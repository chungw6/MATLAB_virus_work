lambda_e = 50;
lambda_f = 50;
beta_e = 0.00072;
beta_f = beta_e;
beta_e1 = 0.00065;
beta_f1 = beta_e1;
d = 0.01;
a = 0.45;
p = 0.001;
eta = 0.01;
 c = 0.0005;
 b = 0.01;
 g = 1;
 h = 2;
%  mu = 0;
  mu = 2e-5;

tspan = linspace(0, 100, 100000);
xinit = [ 782.3446987, 74.87562189, 705.7531291, 84.50875412, 114.5747343, 57.00235538, 0., 0.];
xinit1 = [ 1584.074144, 29.95024876, 1111.773141, 48.57389413, 696.7515777, 346.6425759, 0., 0.];
xinit2 = [ 2405.917840, 14.97512438, 1526.018985, 31.61804459, 1293.374555, 643.4699281, 0., 0.];
xinit3 = [ 4113.053728, 2.995024876, 2399.299197, 15.05474787, 2551.664536, 1269.484844, 0., 0.];
xinit4 = [ 4513.364949, 1.497512438, 2622.916775, 12.5871495, 2873.676486, 1429.689794, 0., 0.];

% 
% gxinit = [ 2049.180328, 20., 635.9742669, 95.30490724, 1063.062290, 0., 0., 0.];
% gxinit1 = [ 2043.181264, 20.09950249, 643.2313448, 94.07295874, 1057.894135, 5.263154902, 0., 0.];
% gxinit2 = [ 1990.729736, 20.99502488, 705.4783339, 84.54708159, 1013.595465, 50.42763510, 0., 0.];
% gxinit3 = [ 1584.074144, 29.95024876, 1111.773141, 48.57389413, 696.7515777, 346.6425759, 0., 0.];

% [t1,x1]=ode45(@(t,x) twocomp_escape_model(t, x, lambda_e, lambda_f, beta_e, beta_e1, beta_f, beta_f1, d, a, p, 0.0001, c, b, g, h), tspan, xinit);
[t2,x2]=ode45(@(t,x) twocomp_escape_model_mutation(t, x, lambda_e,...
    lambda_f, beta_e, beta_e1, beta_f, beta_f1, d, a, p, eta, 0.0002, b, g, h,...
    mu), tspan, xinit);
[t2,x3]=ode45(@(t,x) twocomp_escape_model_mutation(t, x, lambda_e,...
    lambda_f, beta_e, beta_e1, beta_f, beta_f1, d, a, p, eta, 0.0005, b, g, h,...
    mu), tspan, xinit1);
[t2,x4]=ode45(@(t,x) twocomp_escape_model_mutation(t, x, lambda_e,...
    lambda_f, beta_e, beta_e1, beta_f, beta_f1, d, a, p, eta, 0.001, b, g, h,...
    mu), tspan, xinit2);
[t2,x5]=ode45(@(t,x) twocomp_escape_model_mutation(t, x, lambda_e,...
    lambda_f, beta_e, beta_e1, beta_f, beta_f1, d, a, p, eta, 0.005, b, g, h,...
    mu), tspan, xinit3);
[t2,x6]=ode45(@(t,x) twocomp_escape_model_mutation(t, x, lambda_e,...
    lambda_f, beta_e, beta_e1, beta_f, beta_f1, d, a, p, eta, 0.01, b, g, h,...
    mu), tspan, xinit4);

% [t3,x3]=ode45(@(t,x) twocomp_escape_model(t, x, lambda_e, lambda_f, beta_e, beta_e1, beta_f, beta_f1, d, a, p, 0.01, c, b, g, h), tspan, xinit);
% [t4,x4]=ode45(@(t,x) twocomp_escape_model(t, x, lambda_e, lambda_f, beta_e, beta_e1, beta_f, beta_f1, d, a, p, 0.1, c, b, g, h), tspan, xinit);
% [t5,x5]=ode45(@(t,x) twocomp_escape_model(t, x, lambda_e, lambda_f, beta_e, beta_e1, beta_f, beta_f1, d, a, p, 1, c, b, g, h), tspan, xinit);
% [t6,x6]=ode45(@(t,x) twocomp_escape_model(t, x, lambda_e, lambda_f, beta_e, beta_e1, beta_f, beta_f1, d, a, p, 10, c, b, g, h), tspan, xinit);

% [t2,gx2]=ode45(@(t,x) twocomp_escape_model_mutation(t, x, lambda_e,...
%     lambda_f, beta_e, beta_e1, beta_f, beta_f1, d, a, p, eta, c, b, 0, h,...
%     mu), tspan, gxinit);
% [t2,gx3]=ode45(@(t,x) twocomp_escape_model_mutation(t, x, lambda_e,...
%     lambda_f, beta_e, beta_e1, beta_f, beta_f1, d, a, p, eta, c, b, 0.01, h,...
%     mu), tspan, gxinit1);
% [t2,gx4]=ode45(@(t,x) twocomp_escape_model_mutation(t, x, lambda_e,...
%     lambda_f, beta_e, beta_e1, beta_f, beta_f1, d, a, p, eta, c, b, 0.1, h,...
%     mu), tspan, gxinit2);
% [t2,gx5]=ode45(@(t,x) twocomp_escape_model_mutation(t, x, lambda_e,...
%     lambda_f, beta_e, beta_e1, beta_f, beta_f1, d, a, p, eta, c, b, 1, h,...
%     mu), tspan, gxinit3);


figure(1)
subplot(2,1,1);
%plot(t1,x(:,1), t2,x2(:,1),t3,x3(:,1),t4,x4(:,1),'--',t5,x5(:,1),'--',t6,x6(:,1),'--',t7,x7(:,1),'--',t8,x8(:,1),'--')
semilogy(t2,abs(x2(:,2)),'--',... 
    t2,abs(x3(:,2)),...
    t2,abs(x4(:,2)),...
    t2,abs(x5(:,2)),...
    t2,abs(x6(:,2)))
%     t2,abs(x2(:,4)),...
%     t2,abs(x2(:,6)),'--',...
%     t2,abs(x2(:,8)),'.')
%     t6,abs(x6(:,2)),'.', ...
%     t6,abs(x6(:,5)),'--',...
%     t6,abs(x6(:,7)),'-.',...
%     t6,abs(x6(:,4)),...
%     t6,abs(x6(:,6)),':',...
%     t6,abs(x6(:,8)),'o'...
  ylim([1e-3,1e2])   
legend('c=0.0002',...
    'c=0.0005',...
    'c=0.001',...
    'c=0.005',...
    'c=0.01')
%     'Y_f, \eta = 0.01',...
%     'Z_{f}, \eta = 0.01',...
%     'Y_{1f}, \eta = 0.01')
%     'Y_e, \eta = 10',...
%     'Z_{e}, \eta = 10',...
%     'Y_{1e}, \eta = 10',...
%     'Y_f, \eta = 10',...
%     'Z_{f}, \eta = 10',...
%     'Y_{1f}, \eta = 10'...
    
 xlabel('Time')
 
 ylabel('Numbers of cells (Y_e)')
 
subplot(2,1,2);
semilogy(t2,abs(x2(:,4)),'--',... 
    t2,abs(x3(:,4)),...
    t2,abs(x4(:,4)),...
    t2,abs(x5(:,4)),...
    t2,abs(x6(:,4)))
 
  ylim([1e-3,1e2])  
 
legend('c=0.0002',...
    'c=0.0005',...
    'c=0.001',...
    'c=0.005',...
    'c=0.01')
 
 xlabel('Time')
 
 ylabel('Numbers of cells (Y_f)')
 
  figure(2)
  subplot(2,1,1);
semilogy(t2,abs(x2(:,5)),'--',... 
    t2,abs(x3(:,5)),...
    t2,abs(x4(:,5)),...
    t2,abs(x5(:,5)),...
    t2,abs(x6(:,5)))
 
%   ylim([1e-2,3e3]) 
 
legend('c=0.0002',...
    'c=0.0005',...
    'c=0.001',...
    'c=0.005',...
    'c=0.01')
 
 xlabel('Time')
 
 ylabel('Numbers of cells (Z_e)') 
 
 
subplot(2,1,2);
semilogy(t2,abs(x2(:,6)),'--',... 
    t2,abs(x3(:,6)),...
    t2,abs(x4(:,6)),...
    t2,abs(x5(:,6)),...
    t2,abs(x6(:,6)))
 
%   ylim([1e-2,1e3])  
 
legend('c=0.0002',...
    'c=0.0005',...
    'c=0.001',...
    'c=0.005',...
    'c=0.01')
 
 xlabel('Time')
 
 ylabel('Numbers of cells (Z_f)') 
 
 
  figure(3)
subplot(2,1,1);  
semilogy(t2,abs(x2(:,7)),'--',... 
    t2,abs(x3(:,7)),...
    t2,abs(x4(:,7)),...
    t2,abs(x5(:,7)),...
    t2,abs(x6(:,7)))
 
  ylim([1e-3,1e3])  
 
legend('c=0.0002',...
    'c=0.0005',...
    'c=0.001',...
    'c=0.005',...
    'c=0.01')
 
 xlabel('Time')
 
 ylabel('Numbers of cells (Y_{1e})') 
 
subplot(2,1,2);
semilogy(t2,abs(x2(:,8)),'--',... 
    t2,abs(x3(:,8)),...
    t2,abs(x4(:,8)),...
    t2,abs(x5(:,8)),...
    t2,abs(x6(:,8)))
 
  ylim([1e-3,1e3]) 
 
legend('c=0.0002',...
    'c=0.0005',...
    'c=0.001',...
    'c=0.005',...
    'c=0.01')
 
 xlabel('Time')
 
 ylabel('Numbers of cells (Y_{1f})') 

% semilogy(t1,x(:,1),t1,x(:,2),t1,x(:,3),'--',t1,x(:,4),'--',t1,x(:,5),t1,x(:,6),'--',t1,x(:,7),t1,x(:,8),'--')
% ylim([1e-2,5000])
% legend('X_e', 'Y_e', 'X_f', 'Y_f', 'Z_e', 'Z_f', 'Y_{e1}', 'Y_{f1}')
% xlabel('Time')
% ylabel('Number of cells')

% figure(4)
% subplot(2,1,1);
% %plot(t1,x(:,1), t2,x2(:,1),t3,x3(:,1),t4,x4(:,1),'--',t5,x5(:,1),'--',t6,x6(:,1),'--',t7,x7(:,1),'--',t8,x8(:,1),'--')
% semilogy(t2,abs(gx2(:,2)),'--',... 
%     t2,abs(gx3(:,2)),...
%     t2,abs(gx4(:,2)),...
%     t2,abs(gx5(:,2)))
% %     t2,abs(x2(:,4)),...
% %     t2,abs(x2(:,6)),'--',...
% %     t2,abs(x2(:,8)),'.')
% %     t6,abs(x6(:,2)),'.', ...
% %     t6,abs(x6(:,5)),'--',...
% %     t6,abs(x6(:,7)),'-.',...
% %     t6,abs(x6(:,4)),...
% %     t6,abs(x6(:,6)),':',...
% %     t6,abs(x6(:,8)),'o'...
%   ylim([1e-2,1e2])    
% legend('g=0',...
%     'g=0.01',...
%     'g=0.1',...
%     'g=1')
% %     'Y_f, \eta = 0.01',...
% %     'Z_{f}, \eta = 0.01',...
% %     'Y_{1f}, \eta = 0.01')
% %     'Y_e, \eta = 10',...
% %     'Z_{e}, \eta = 10',...
% %     'Y_{1e}, \eta = 10',...
% %     'Y_f, \eta = 10',...
% %     'Z_{f}, \eta = 10',...
% %     'Y_{1f}, \eta = 10'...
%     
%  xlabel('Time')
%  
%  ylabel('Numbers of cells (Y_e)')
%  
% subplot(2,1,2);
% semilogy(t2,abs(gx2(:,4)),'--',... 
%     t2,abs(gx3(:,4)),...
%     t2,abs(gx4(:,4)),...
%     t2,abs(gx5(:,4)))
%  
%   ylim([1e-2,1e2])  
%  
% legend('g=0',...
%     'g=0.01',...
%     'g=0.1',...
%     'g=1')
%  
%  xlabel('Time')
%  
%  ylabel('Numbers of cells (Y_f)')
%  
%   figure(5)
%   subplot(2,1,1);
% semilogy(t2,abs(gx2(:,5)),'--',... 
%     t2,abs(gx3(:,5)),...
%     t2,abs(gx4(:,5)),...
%     t2,abs(gx5(:,5)))
%  
% %   ylim([1e-2,3e3])  
%  
% legend('g=0',...
%     'g=0.01',...
%     'g=0.1',...
%     'g=1')
%  
%  xlabel('Time')
%  
%  ylabel('Numbers of cells (Z_e)') 
%  
%  
% subplot(2,1,2);
% semilogy(t2,abs(gx2(:,6)),'--',... 
%     t2,abs(gx3(:,6)),...
%     t2,abs(gx4(:,6)),...
%     t2,abs(gx5(:,6)))
%  
% %   ylim([1e-2,3e3]) 
%  
% legend('g=0',...
%     'g=0.01',...
%     'g=0.1',...
%     'g=1')
%  
%  xlabel('Time')
%  
%  ylabel('Numbers of cells (Z_f)') 
%  
%  
%   figure(6)
% subplot(2,1,1);  
% semilogy(t2,abs(gx2(:,7)),'--',... 
%     t2,abs(gx3(:,7)),...
%     t2,abs(gx4(:,7)),...
%     t2,abs(gx5(:,7)))
%  
%   ylim([1e-3,1e3]) 
%  
% legend('g=0',...
%     'g=0.01',...
%     'g=0.1',...
%     'g=1')
%  
%  xlabel('Time')
%  
%  ylabel('Numbers of cells (Y_{1e})') 
%  
% subplot(2,1,2);
% semilogy(t2,abs(gx2(:,8)),'--',... 
%     t2,abs(gx3(:,8)),...
%     t2,abs(gx4(:,8)),...
%     t2,abs(gx5(:,8)))
%  
%   ylim([1e-3,1e3])  
%  
% legend('g=0',...
%     'g=0.01',...
%     'g=0.1',...
%     'g=1')
%  
%  xlabel('Time')
%  
%  ylabel('Numbers of cells (Y_{1f})') 
 
lambda = 100;
beta = 0.00072;
beta_1 = 0.00065;

one_compxinit = [ 2173.913043, 50., 1115.217391, 0.];
one_compxinit1 = [ 4098.360656, 20., 2500.819672, 0.];
one_compxinit2 = [ 5813.953488, 10., 3736.046512, 0.];
one_compxinit3 = [ 8741.258741, 2., 5843.706294, 0.];
one_compxinit4 = [ 9328.358209, 1., 6266.417910, 0.];

[t2,one_compx]=ode45(@(t,x) escape_model_mutation(t, x, lambda,...
    beta, beta_1, d, a, p, 0.0002, b,...
    mu), tspan, one_compxinit);
[t2,one_compx2]=ode45(@(t,x) escape_model_mutation(t, x, lambda,...
    beta, beta_1, d, a, p, 0.0005, b,...
    mu), tspan, one_compxinit1);
[t2,one_compx3]=ode45(@(t,x) escape_model_mutation(t, x, lambda,...
    beta, beta_1, d, a, p, 0.001, b,...
    mu), tspan, one_compxinit2);
[t2,one_compx4]=ode45(@(t,x) escape_model_mutation(t, x, lambda,...
    beta, beta_1, d, a, p, 0.005, b,...
    mu), tspan, one_compxinit3);
[t2,one_compx5]=ode45(@(t,x) escape_model_mutation(t, x, lambda,...
    beta, beta_1, d, a, p, 0.01, b,...
    mu), tspan, one_compxinit4);

figure(7)
subplot(3,1,1);
%plot(t1,x(:,1), t2,x2(:,1),t3,x3(:,1),t4,x4(:,1),'--',t5,x5(:,1),'--',t6,x6(:,1),'--',t7,x7(:,1),'--',t8,x8(:,1),'--')
semilogy(t2,abs(x2(:,2) + x2(:,4)),'--',... 
    t2,abs(x3(:,2) + x3(:,4)),...
    t2,abs(x4(:,2) + x4(:,4)),...
    t2,abs(x5(:,2) + x5(:,4)),...
    t2,abs(x6(:,2) + x6(:,4)),...
    t2,abs(one_compx(:,2)),'.',...
    t2,abs(one_compx2(:,2)),'.',...
    t2,abs(one_compx3(:,2)),'.',...
    t2,abs(one_compx4(:,2)),'.',...
    t2,abs(one_compx5(:,2)),'.')
%     t2,abs(x2(:,4)),...
%     t2,abs(x2(:,6)),'--',...
%     t2,abs(x2(:,8)),'.')
%     t6,abs(x6(:,2)),'.', ...
%     t6,abs(x6(:,5)),'--',...
%     t6,abs(x6(:,7)),'-.',...
%     t6,abs(x6(:,4)),...
%     t6,abs(x6(:,6)),':',...
%     t6,abs(x6(:,8)),'o'...
  ylim([1e-3,1e2])   
legend('c=0.0002',...
    'c=0.0005',...
    'c=0.001',...
    'c=0.005',...
    'c=0.01',...
    '1C c=0.0002',...
    '1C c=0.0005',...
    '1C c=0.001',...
    '1C c=0.005',...
    '1C c=0.01')
%     'Y_f, \eta = 0.01',...
%     'Z_{f}, \eta = 0.01',...
%     'Y_{1f}, \eta = 0.01')
%     'Y_e, \eta = 10',...
%     'Z_{e}, \eta = 10',...
%     'Y_{1e}, \eta = 10',...
%     'Y_f, \eta = 10',...
%     'Z_{f}, \eta = 10',...
%     'Y_{1f}, \eta = 10'...
    
 xlabel('Time')
 
 ylabel('Numbers of cells (Y)')
 
subplot(3,1,2);
semilogy(t2,abs(x2(:,5) + x2(:,6)),'--',... 
    t2,abs(x3(:,5) + x3(:,6)),...
    t2,abs(x4(:,5) + x4(:,6)),...
    t2,abs(x5(:,5) + x5(:,6)),...
    t2,abs(x6(:,5) + x6(:,6)),...
    t2,abs(one_compx(:,3)),'.',...
    t2,abs(one_compx2(:,3)),'.',...
    t2,abs(one_compx3(:,3)),'.',...
    t2,abs(one_compx4(:,3)),'.',...
    t2,abs(one_compx5(:,3)),'.')
 
%  ylim([1e-3,1e2])  
 
legend('c=0.0002',...
    'c=0.0005',...
    'c=0.001',...
    'c=0.005',...
    'c=0.01',...
    '1C c=0.0002',...
    '1C c=0.0005',...
    '1C c=0.001',...
    '1C c=0.005',...
    '1C c=0.01')
 
 xlabel('Time')
 
 ylabel('Numbers of cells (Z)')
 
 subplot(3,1,3);
semilogy(t2,abs(x2(:,7) + x2(:,8)),'--',... 
    t2,abs(x3(:,7) + x3(:,8)),...
    t2,abs(x4(:,7) + x4(:,8)),...
    t2,abs(x5(:,7) + x5(:,8)),...
    t2,abs(x6(:,7) + x6(:,8)),...
    t2,abs(one_compx(:,4)),'.',...
    t2,abs(one_compx2(:,4)),'.',...
    t2,abs(one_compx3(:,4)),'.',...
    t2,abs(one_compx4(:,4)),'.',...
    t2,abs(one_compx5(:,4)),'.')
 
%  ylim([1e-3,1e2])  
 
legend('c=0.0002',...
    'c=0.0005',...
    'c=0.001',...
    'c=0.005',...
    'c=0.01',...
    '1C c=0.0002',...
    '1C c=0.0005',...
    '1C c=0.001',...
    '1C c=0.005',...
    '1C c=0.01')
 
 xlabel('Time')
 
 ylabel('Numbers of cells (Y_1)')
 
 
% figure(8)
% subplot(3,1,1);
% %plot(t1,x(:,1), t2,x2(:,1),t3,x3(:,1),t4,x4(:,1),'--',t5,x5(:,1),'--',t6,x6(:,1),'--',t7,x7(:,1),'--',t8,x8(:,1),'--')
% semilogy(t2,abs(gx2(:,2) + gx2(:,4)),'--',... 
%     t2,abs(gx3(:,2) + gx3(:,4)),...
%     t2,abs(gx4(:,2) + gx4(:,4)),...
%     t2,abs(gx5(:,2) + gx5(:,4)),...
%     t2,abs(one_compx2(:,2)),'.')
% %     t2,abs(x2(:,4)),...
% %     t2,abs(x2(:,6)),'--',...
% %     t2,abs(x2(:,8)),'.')
% %     t6,abs(x6(:,2)),'.', ...
% %     t6,abs(x6(:,5)),'--',...
% %     t6,abs(x6(:,7)),'-.',...
% %     t6,abs(x6(:,4)),...
% %     t6,abs(x6(:,6)),':',...
% %     t6,abs(x6(:,8)),'o'...
% %  ylim([1e-3,1e2])   
% legend('g=0',...
%     'g=0.01',...
%     'g=0.1',...
%     'g=1', '1 Comp')
% %     'Y_f, \eta = 0.01',...
% %     'Z_{f}, \eta = 0.01',...
% %     'Y_{1f}, \eta = 0.01')
% %     'Y_e, \eta = 10',...
% %     'Z_{e}, \eta = 10',...
% %     'Y_{1e}, \eta = 10',...
% %     'Y_f, \eta = 10',...
% %     'Z_{f}, \eta = 10',...
% %     'Y_{1f}, \eta = 10'...
%     
%  xlabel('Time')
%  
%  ylabel('Numbers of cells (Y)')
%  
% subplot(3,1,2);
% semilogy(t2,abs(gx2(:,5) + gx2(:,6)),'--',... 
%     t2,abs(gx3(:,5) + gx3(:,6)),...
%     t2,abs(gx4(:,5) + gx4(:,6)),...
%     t2,abs(gx5(:,5) + gx5(:,6)),...
%     t2,abs(one_compx2(:,3)),'.')
%  
% %  ylim([1e-3,1e2])  
%  
% legend('g=0',...
%     'g=0.01',...
%     'g=0.1',...
%     'g=1', '1 Comp')
%  
%  xlabel('Time')
%  
%  ylabel('Numbers of cells (Z)')
%  
%  subplot(3,1,3);
% semilogy(t2,abs(gx2(:,7) + gx2(:,8)),'--',... 
%     t2,abs(gx3(:,7) + gx3(:,8)),...
%     t2,abs(gx4(:,7) + gx4(:,8)),...
%     t2,abs(gx5(:,7) + gx5(:,8)),...
%     t2,abs(one_compx2(:,4)),'.')
%  
% %  ylim([1e-3,1e2])  
%  
% legend('g=0',...
%     'g=0.01',...
%     'g=0.1',...
%     'g=1', '1 Comp')
%  
%  xlabel('Time')
%  
%  ylabel('Numbers of cells (Y_1)')
 

x2(end,1)
x2(end,2)
x2(end,3)
x2(end,4)
x2(end,5)
x2(end,6)
x2(end,7)
x2(end,8)